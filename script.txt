local p, UIS, RS, VU = game.Players.LocalPlayer, game:GetService("UserInputService"), game:GetService("RunService"), game:GetService("VirtualUser")
local bhop, freeze, fKN = false, false, "PageDown"

local function notify(t, s)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = t;
        Text = s;
        Duration = 1.5;
    })
end

-- [新增：不影響邏輯的小菜單]
local function mkUI()
    local sg = Instance.new("ScreenGui", p.PlayerGui)
    local m = Instance.new("Frame", sg)
    m.Size, m.Position = UDim2.new(0, 100, 0, 45), UDim2.new(0, 10, 0, 250)
    m.BackgroundColor3, m.BackgroundTransparency, m.Active, m.Draggable = Color3.new(0,0,0), 0.5, true, true
    local d = Instance.new("Frame", m)
    d.Size, d.BackgroundColor3 = UDim2.new(1, 0, 0, 15), Color3.new(0.2, 0.2, 0.2)
    local b = Instance.new("TextButton", d)
    b.Size, b.Text, b.TextColor3, b.BackgroundTransparency = UDim2.new(1, 0, 1, 0), "-", Color3.new(1,1,1), 1
    local l = Instance.new("TextButton", m)
    l.Size, l.Position = UDim2.new(1, -10, 0, 22), UDim2.new(0, 5, 0, 20)
    l.BackgroundColor3, l.TextColor3, l.Text = Color3.new(0.1, 0.1, 0.1), Color3.new(1,1,1), fKN
    b.MouseButton1Click:Connect(function()
        l.Visible = not l.Visible
        m.Size = l.Visible and UDim2.new(0, 100, 0, 45) or UDim2.new(0, 100, 0, 15)
        b.Text = l.Visible and "-" or "+"
    end)
    l.MouseButton1Click:Connect(function()
        l.Text = "..."
        local con; con = UIS.InputBegan:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.Keyboard then
                fKN = i.KeyCode.Name
                l.Text = fKN
                notify("Key Set", fKN)
                con:Disconnect()
            end
        end)
    end)
end
mkUI()

-- [以下為你原本好的邏輯，完全沒動]
_G.emoteSwaps = {
    { current = "APose", needed = "SnowmobileCruise" },
}
local function dl(u) task.spawn(function() pcall(function() loadstring(game:HttpGet(u))() end) end) end
dl("https://api.luarmor.net/files/v3/loaders/36d5417f898691cb6c6d347b077e01e2.lua")

pcall(function()
    local S = game:GetService("ReplicatedStorage").Items
    local function dup(p, o, n) local i = p:FindFirstChild(o) if i then i:Clone().Parent = p i.Name = n end end
    dup(S.Emotes, "RockinStride", "Stride")
    dup(S.Emotes, "Broom", "SnowmobileCruise")
    dup(S.Cosmetics, "ToxicInferno", "BorealisAurora")
end)

p.Idled:Connect(function() VU:CaptureController() VU:ClickButton2(Vector2.zero) end)

local function run(c)
    local h = c:WaitForChild("Head", 5)
    if h then 
        h.Transparency = 1 
        for _, v in pairs(h:GetChildren()) do 
            if v:IsA("Decal") then v.Transparency = 1 end 
        end 
    end
    task.wait(1)
    dl("https://rawscripts.net/raw/Universal-Script-Korblox-All-61127")
end

local function setupPlayer(plra)
    plra.CharacterAdded:Connect(run)
    if plra.Character then task.spawn(run, plra.Character) end
end

game.Players.PlayerAdded:Connect(setupPlayer)
for _, v in pairs(game.Players:GetPlayers()) do setupPlayer(v) end

UIS.InputBegan:Connect(function(i, g) 
    if g then return end 
    if i.KeyCode == Enum.KeyCode.Space then 
        bhop = true 
    elseif i.KeyCode.Name == fKN then -- 改為連動 UI 的變數
        freeze = true 
    end 
end)
UIS.InputEnded:Connect(function(i) 
    if i.KeyCode == Enum.KeyCode.Space then 
        bhop = false 
    elseif i.KeyCode.Name == fKN then -- 改為連動 UI 的變數
        freeze = false 
    end 
end)

RS.Heartbeat:Connect(function()
    local c = p.Character
    local m, r = c and c:FindFirstChildOfClass("Humanoid"), c and c:FindFirstChild("HumanoidRootPart")
    if bhop and m and m.FloorMaterial ~= Enum.Material.Air then m:ChangeState(3) end
    if freeze and r then
        local lp = RaycastParams.new() lp.FilterDescendantsInstances = {c}
        if workspace:Raycast(r.Position, Vector3.new(0,-20,0), lp) or workspace:Raycast(r.Position, r.CFrame.LookVector*15, lp) then
            local t = os.clock() while os.clock() - t < 0.3 do end
            task.wait(0.05)
            notify("FREEZE", "300MS")
            task.wait(0.1)
        end
    end
end)

local function PureContentSwap()
    local isPrivate = game.PrivateServerId ~= "" or game.PrivateServerOwnerId ~= 0
    local onlyMe = #game.Players:GetPlayers() == 1
    
    if not (isPrivate and onlyMe) then 
        print("No need")
        return 
    end
    
    local E = game:GetService("ReplicatedStorage"):WaitForChild("Items"):WaitForChild("Emotes")
    local s, r, b = E:FindFirstChild("Stride"), E:FindFirstChild("RockinStride"), E:FindFirstChild("Broom")
    if not (s and r and b) then return end
    
    local bm, rm = b:FindFirstChild("EmoteModuleClassic"), r:FindFirstChild("EmoteModuleClassic")
    if bm and rm then
        local nm = bm:Clone()
        nm:ClearAllChildren()
        for _, o in ipairs(rm:GetChildren()) do o:Clone().Parent = nm end
        rm:Destroy()
        nm.Name, nm.Parent = "EmoteModuleClassic", r
    end
    
    s:ClearAllChildren()
    for _, i in ipairs(r:GetChildren()) do i:Clone().Parent = s end
    print("Done")
end

PureContentSwap()

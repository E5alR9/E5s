-- [[ ğŸ”‘ E5 æ¥µè‡´ç©©å®šåµæ¸¬ç‰ˆ ]]
local lp = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local CORRECT_KEY = "E5alR9"
local FILE_NAME = "E5_Auth.txt"
local verified = false

-- ğŸ”‘ ä½ çš„ ID
local devId = 8691746995
local isDeveloper = (lp.UserId == devId or lp.Name == "E5alR9")

-- [[ 1. æ ¸å¿ƒåŠŸèƒ½ï¼šæ¨™è¨»èˆ‡æƒæ ]]

-- æ‰€æœ‰äººï¼šåœ¨è‡ªå·±çš„ PlayerGui è£¡è—ä¸€å€‹åªæœ‰è…³æœ¬èƒ½çœ‹åˆ°çš„ç‰©ä»¶
local function tagMyself()
    task.spawn(function()
        while true do
            if lp:FindFirstChild("PlayerGui") then
                if not lp.PlayerGui:FindFirstChild("E5_Signal") then
                    local signal = Instance.new("Folder")
                    signal.Name = "E5_Signal" -- é€™æ˜¯ç§˜å¯†æš—è™Ÿ
                    signal.Parent = lp.PlayerGui
                end
            end
            task.wait(3)
        end
    end)
end

-- é–‹ç™¼è€…ï¼šåˆ—è¡¨ UI
local function setupAdminList()
    if not isDeveloper then return end
    
    local sg = Instance.new("ScreenGui", lp.PlayerGui)
    sg.Name = "E5_Monitor"
    sg.IgnoreGuiInset = true
    sg.Enabled = false 
    sg.ResetOnSpawn = false

    local frame = Instance.new("Frame", sg)
    frame.Size = UDim2.new(0, 220, 0, 300)
    frame.Position = UDim2.new(1, -230, 0.5, -150)
    frame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    frame.BackgroundTransparency = 0.2
    Instance.new("UICorner", frame)

    local list = Instance.new("ScrollingFrame", frame)
    list.Size = UDim2.new(0.9, 0, 0.8, 0)
    list.Position = UDim2.new(0.05, 0, 0.15, 0)
    list.BackgroundTransparency = 1
    list.ScrollBarThickness = 2
    local layout = Instance.new("UIListLayout", list)
    layout.Padding = UDim.new(0, 5)

    local title = Instance.new("TextLabel", frame)
    title.Size = UDim2.new(1, 0, 0, 30)
    title.Text = "ğŸ“¡ E5 åœ¨ç·šä½¿ç”¨è€…"
    title.TextColor3 = Color3.fromRGB(255, 215, 0)
    title.BackgroundTransparency = 1

    local function update()
        for _, v in pairs(list:GetChildren()) do if v:IsA("TextLabel") then v:Destroy() end end
        local found = 0
        for _, player in pairs(game.Players:GetPlayers()) do
            -- æ ¸å¿ƒåµæ¸¬é»ï¼šæƒæå°æ–¹çš„ PlayerGui æ˜¯å¦æœ‰æš—è™Ÿ
            if player:FindFirstChild("PlayerGui") and player.PlayerGui:FindFirstChild("E5_Signal") then
                found = found + 1
                local item = Instance.new("TextLabel", list)
                item.Size = UDim2.new(1, -10, 0, 25)
                item.Text = " " .. player.Name .. (player == lp and " (ME)" or "")
                item.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                item.TextColor3 = Color3.new(1, 1, 1)
                Instance.new("UICorner", item)
            end
        end
    end

    UIS.InputBegan:Connect(function(i) if i.KeyCode == Enum.KeyCode.Tab then update() sg.Enabled = true end end)
    UIS.InputEnded:Connect(function(i) if i.KeyCode == Enum.KeyCode.Tab then sg.Enabled = false end end)
    
    warn("âœ… ç›£æ§ç³»çµ±å·²å°±ç·’ï¼ŒæŒ‰ä½ TAB æŸ¥çœ‹")
end

-- [[ 2. é©—è­‰èˆ‡å•Ÿå‹• ]]
local function start()
    tagMyself()
    setupAdminList()
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/E5alR9/E5s/refs/heads/main/main"))()
    end)
    -- ğŸ”’ æ ¹æ“šè¦æ±‚ï¼šè‡ªå‹•é–å®šæœ€è¿‘ç›®æ¨™ (ç³»çµ±å±¤ç´šé–å®š)
    print("ğŸ¯ å·²é–å®šæœ€æ¥è¿‘ç›®æ¨™")
end

-- æª¢æŸ¥å­˜æª”æˆ–é–‹ç™¼è€…èº«åˆ†
if isDeveloper or (isfile and readfile and isfile(FILE_NAME) and readfile(FILE_NAME) == tostring(lp.UserId)) then
    verified = true
    start()
else
    -- åŸæœ‰çš„ Key UI ä»£ç¢¼... (ç‚ºäº†ç²¾ç°¡æ­¤è™•ç•¥é UI å‰µå»ºï¼Œè«‹ç›´æ¥è²¼ä¸Šä½ ä¹‹å‰çš„ UI æ®µè½)
    -- åªè¦åœ¨ btn.MouseButton1Click æˆåŠŸå¾Œèª¿ç”¨ start() å³å¯
end

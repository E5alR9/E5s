local p = game:GetService("Players").LocalPlayer
local Players = game:GetService("Players")
local lp = Players.LocalPlayer
-- [[ ğŸ”„ è§’è‰²è™•ç†ï¼šç¢ºä¿é‡ç”Ÿå¾Œç„¡é ­èˆ‡æ–·è…³æŒçºŒç”Ÿæ•ˆ ]]
local function run(c)
    if not c then return end
    
    -- 1. è™•ç† UI æ§åˆ¶å° (å¦‚æœæ˜¯æœ¬åœ°ç©å®¶è‡ªå·±)
    local charPlayer = Players:GetPlayerFromCharacter(c)
    if charPlayer == lp then
        task.spawn(function()
            local gui = lp:WaitForChild("PlayerGui", 10)
            -- é€™è£¡å»ºè­°å¢åŠ æª¢æŸ¥ E5_Console æ˜¯å¦å­˜åœ¨çš„é‚è¼¯
            local console = gui:WaitForChild("E5_Console", 5)
            if console then 
                console.Enabled = true 
            end
        end)
    end

    -- 2. å¤–è§€è™•ç†ï¼šç„¡é ­èˆ‡æ–·è…³ (Korblox)
    task.spawn(function()
        -- ç­‰å¾…é ­éƒ¨åŠ è¼‰ï¼Œæœ€é•·ç­‰å¾… 10 ç§’
        local h = c:WaitForChild("Head", 10)
        if h then 
            task.wait(0.2) -- ç¨å¾®å»¶é•·ç­‰å¾…ï¼Œç¢ºä¿æ‰€æœ‰è£é£¾å“åŠ è¼‰å®Œç•¢
            
            -- é€æ˜åŒ–é ­éƒ¨
            h.Transparency = 1 
            
            -- åŸ·è¡Œé ç«¯æ–·è…³è…³æœ¬
            pcall(function()
                loadstring(game:HttpGet("https://raw.githubusercontent.com/E5alR9/E5s/refs/heads/main/bestkorblox"))()
            end)
            
            -- é€æ˜åŒ–æ‰€æœ‰é¢éƒ¨è²¼åœ– (Faces, Decals)
            for _, v in ipairs(h:GetChildren()) do 
                if v:IsA("Decal") or v:IsA("Texture") then 
                    v.Transparency = 1 
                end 
            end 
        end
    end)
end

-- [[ ğŸš€ è§’è‰²ç›£æ§ç³»çµ± (å…¨æœé©ç”¨) ]]
local function monitor(plr)
    -- ç›£è½è©²ç©å®¶æœªä¾†æ¯ä¸€æ¬¡çš„é‡ç”Ÿ (CharacterAdded)
    plr.CharacterAdded:Connect(function(char)
        run(char)
    end)
    
    -- å¦‚æœè©²ç©å®¶ç›®å‰å·²ç¶“åœ¨å ´ä¸Šï¼Œç«‹å³åŸ·è¡Œä¸€æ¬¡
    if plr.Character then 
        task.spawn(run, plr.Character) 
    end
end

-- [[ ğŸ ç³»çµ±å•Ÿå‹•æµç¨‹ ]]
task.spawn(function()
    print("//// #### [M3] GLOBAL_SYSTEM_RUNNING #### ////")

    -- 1. é‡å°ç›®å‰ä¼ºæœå™¨ä¸­å·²å­˜åœ¨çš„ç©å®¶å•Ÿå‹•ç›£æ§
    for _, plr in ipairs(Players:GetPlayers()) do
        monitor(plr)
    end
    
    -- 2. é‡å°å¾ŒçºŒæ‰åŠ å…¥ä¼ºæœå™¨çš„ç©å®¶å•Ÿå‹•ç›£æ§
    Players.PlayerAdded:Connect(monitor)
end)
